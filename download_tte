from astroquery.gsaw import GcnArchive

from astropy.io import fits

import requests

def download_gbm_tte_files(grb_name, output_directory):

    # Query the GCN archive for the GRB data

    gcn = GcnArchive()

    gcn_results = gcn.query_grb(name=grb_name)

    

    # Find the URLs of the TTE files

    tte_urls = []

    for result in gcn_results:

        if result['instrument_name'] == 'GBM':

            for file_info in result['file']:

                if file_info['filetype'] == 'tte':

                    tte_urls.append(file_info['url'])

    

    # Download the TTE files

    for url in tte_urls:

        response = requests.get(url, stream=True)

        file_name = url.split('/')[-1]

        file_path = f"{output_directory}/{file_name}"

        

        with open(file_path, 'wb') as file:

            for chunk in response.iter_content(chunk_size=1024):

                file.write(chunk)

        

        print(f"Downloaded: {file_name}")

    

    print("Download completed.")

# Example usage

grb_name = "GRB190114C"

output_directory = "/path/to/output/directory"

download_gbm_tte_files(grb_name, output_directory)










